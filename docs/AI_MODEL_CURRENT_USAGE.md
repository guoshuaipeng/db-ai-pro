# AIæ¨¡å‹ï¼šä»é»˜è®¤æ¨¡å‹åˆ°å½“å‰ä½¿ç”¨æ¨¡å‹

## ğŸ“‹ æ›´æ–°è¯´æ˜

æœ¬æ¬¡æ›´æ–°ç§»é™¤äº†"é»˜è®¤æ¨¡å‹"çš„æ¦‚å¿µï¼Œæ”¹ä¸º"å½“å‰ä½¿ç”¨æ¨¡å‹"ï¼Œç¨‹åºä¼šè‡ªåŠ¨è®°ä½æ‚¨ä¸Šæ¬¡ä½¿ç”¨çš„æ¨¡å‹ã€‚

## ğŸ¯ ä¸»è¦å˜æ›´

### 1. ç§»é™¤"é»˜è®¤æ¨¡å‹"æ¦‚å¿µ
- âœ… ç§»é™¤äº†AIæ¨¡å‹é…ç½®ä¸­çš„"è®¾ç½®ä¸ºé»˜è®¤æ¨¡å‹"é€‰é¡¹
- âœ… ç¨‹åºè‡ªåŠ¨è®°ä½ä¸Šæ¬¡ä½¿ç”¨çš„æ¨¡å‹
- âœ… ä¸‹æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨ä½¿ç”¨ä¸Šæ¬¡çš„æ¨¡å‹

### 2. ç”¨æˆ·ç•Œé¢æ›´æ–°

#### AIæ¨¡å‹é…ç½®å¯¹è¯æ¡†
- **ä¹‹å‰**: æœ‰"â­ è®¾ä¸ºé»˜è®¤"å¤é€‰æ¡†
- **ç°åœ¨**: ç§»é™¤æ­¤é€‰é¡¹ï¼Œç•Œé¢æ›´ç®€æ´

#### AIæ¨¡å‹ç®¡ç†å¯¹è¯æ¡†
- **ä¹‹å‰**: æ¨¡å‹åç§°åæ˜¾ç¤º `[é»˜è®¤]` æ ‡è®°
- **ç°åœ¨**: æ˜¾ç¤º `[å½“å‰]` æ ‡è®°ï¼Œè¡¨ç¤ºå½“å‰æ­£åœ¨ä½¿ç”¨çš„æ¨¡å‹

#### AIæ¨¡å‹ä¸‹æ‹‰æ¡†
- **ä¹‹å‰**: æ˜¾ç¤º `æ¨¡å‹åç§° [é»˜è®¤]`
- **ç°åœ¨**: æ˜¾ç¤º `æ¨¡å‹åç§° [å½“å‰]`

### 3. å·¥ä½œæœºåˆ¶

#### è‡ªåŠ¨è®°å¿†
1. å½“æ‚¨é€‰æ‹©ä¸€ä¸ªAIæ¨¡å‹æ‰§è¡Œæ“ä½œæ—¶
2. ç¨‹åºè‡ªåŠ¨å°†è¯¥æ¨¡å‹IDä¿å­˜åˆ°é…ç½®æ•°æ®åº“
3. ä¸‹æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½è¯¥æ¨¡å‹

#### ä¼˜å…ˆçº§
1. **é¦–é€‰**: ä¸Šæ¬¡ä½¿ç”¨çš„æ¨¡å‹ï¼ˆå¦‚æœå­˜åœ¨ä¸”æ¿€æ´»ï¼‰
2. **å¤‡é€‰**: ç¬¬ä¸€ä¸ªæ¿€æ´»çš„æ¨¡å‹
3. **æ— å¯ç”¨**: æç¤ºç”¨æˆ·é…ç½®æ¨¡å‹

## ğŸ”„ APIå…¼å®¹æ€§

ä¸ºäº†ä¿æŒä»£ç å‘åå…¼å®¹ï¼Œä¿ç•™äº†ä»¥ä¸‹æ–¹æ³•ï¼ˆå†…éƒ¨å®ç°å·²æ›´æ”¹ï¼‰ï¼š

```python
# AIModelStorage
def get_default_model() -> Optional[AIModelConfig]:
    """è·å–é»˜è®¤æ¨¡å‹ï¼ˆå®é™…è¿”å›å½“å‰ä½¿ç”¨çš„æ¨¡å‹ï¼‰"""
    return self.get_current_model()

# ConfigDB  
def get_default_ai_model() -> Optional[Dict[str, Any]]:
    """è·å–é»˜è®¤AIæ¨¡å‹ï¼ˆå®é™…è¿”å›å½“å‰ä½¿ç”¨çš„æ¨¡å‹ï¼‰"""
    return self.get_current_ai_model()
```

## ğŸ“ æ•°æ®åº“å­—æ®µ

### ä¿ç•™ä½†ä¸å†ä½¿ç”¨
- `ai_models.is_default` å­—æ®µä»ç„¶å­˜åœ¨ï¼ˆä¸ºäº†å…¼å®¹æ€§ï¼‰
- ä½†æ‰€æœ‰æ–°ä»£ç éƒ½ä¸ä¼šä½¿ç”¨æˆ–è®¾ç½®è¯¥å­—æ®µ
- è¯¥å­—æ®µå§‹ç»ˆä¸º `0` (False)

### å½“å‰ä½¿ç”¨çš„æ¨¡å‹å­˜å‚¨
- å­˜å‚¨ä½ç½®: `settings` è¡¨
- é”®å: `last_used_ai_model_id`
- å€¼: æ¨¡å‹çš„UUID

## âœ¨ ç”¨æˆ·ä½“éªŒæ”¹è¿›

### 1. æ›´ç®€å•
- ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®"é»˜è®¤æ¨¡å‹"
- ç¨‹åºè‡ªåŠ¨è®°ä½æ‚¨çš„é€‰æ‹©

### 2. æ›´ç›´è§‚
- "[å½“å‰]" æ ‡è®°æ›´å‡†ç¡®åœ°åæ˜ å®é™…çŠ¶æ€
- æ¸…æ¥šåœ°çŸ¥é“æ­£åœ¨ä½¿ç”¨å“ªä¸ªæ¨¡å‹

### 3. æ›´çµæ´»
- éšæ—¶åˆ‡æ¢æ¨¡å‹ï¼Œç¨‹åºè‡ªåŠ¨è®°ä½
- ä¸éœ€è¦é¢å¤–çš„"è®¾ä¸ºé»˜è®¤"æ“ä½œ

## ğŸ”§ å¯¹å¼€å‘è€…çš„å½±å“

### æ¨èä½¿ç”¨çš„æ–¹æ³•

```python
# è·å–å½“å‰ä½¿ç”¨çš„æ¨¡å‹ï¼ˆæ–°æ–¹æ³•ï¼‰
storage = AIModelStorage()
current_model = storage.get_current_model()

# æˆ–ä½¿ç”¨å…¼å®¹çš„æ—§æ–¹æ³•
current_model = storage.get_default_model()  # å†…éƒ¨è°ƒç”¨ get_current_model()
```

### ä¿å­˜å½“å‰ä½¿ç”¨çš„æ¨¡å‹

```python
# å½“ç”¨æˆ·é€‰æ‹©ä¸€ä¸ªæ¨¡å‹æ—¶
storage.save_last_used_model_id(model_id)
```

### è·å–å½“å‰æ¨¡å‹ID

```python
# è·å–ä¸Šæ¬¡ä½¿ç”¨çš„æ¨¡å‹ID
current_model_id = storage.get_last_used_model_id()
```

## ğŸ“‚ ä¿®æ”¹çš„æ–‡ä»¶

1. **src/core/ai_model_storage.py**
   - æ·»åŠ  `get_current_model()` æ–¹æ³•
   - `get_default_model()` æ”¹ä¸ºè°ƒç”¨ `get_current_model()`
   - æ›´æ–°é€»è¾‘ä¼˜å…ˆçº§

2. **src/core/config_db.py**
   - æ·»åŠ  `get_current_ai_model()` æ–¹æ³•
   - `get_default_ai_model()` æ”¹ä¸ºè°ƒç”¨ `get_current_ai_model()`
   - ç§»é™¤è®¾ç½®é»˜è®¤æ¨¡å‹çš„é€»è¾‘

3. **src/gui/dialogs/ai_model_dialog.py**
   - ç§»é™¤"â­ è®¾ä¸ºé»˜è®¤"å¤é€‰æ¡†
   - ä¿å­˜æ—¶ `is_default` å§‹ç»ˆä¸º `False`

4. **src/gui/dialogs/ai_model_manager_dialog.py**
   - æ˜¾ç¤º `[å½“å‰]` è€Œä¸æ˜¯ `[é»˜è®¤]`
   - ç§»é™¤é»˜è®¤æ¨¡å‹è®¡æ•°ç»Ÿè®¡

5. **src/gui/handlers/ai_model_handler.py**
   - æ˜¾ç¤º `[å½“å‰]` è€Œä¸æ˜¯ `[é»˜è®¤]`
   - åŸºäº `last_used_ai_model_id` åˆ¤æ–­å½“å‰æ¨¡å‹

## ğŸ¨ ç•Œé¢ç¤ºä¾‹

### AIæ¨¡å‹ä¸‹æ‹‰æ¡†
```
é˜¿é‡Œäº‘åƒé—® [å½“å‰]
DeepSeek V3
ChatGPT 4
```

### AIæ¨¡å‹ç®¡ç†åˆ—è¡¨
```
âœ“ é˜¿é‡Œäº‘åƒé—® [å½“å‰]
âœ“ DeepSeek V3
âœ“ ChatGPT 4
âœ— æ—§æ¨¡å‹ [æœªæ¿€æ´»]
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### è¿ç§»æç¤º
- ä¹‹å‰è®¾ç½®çš„"é»˜è®¤æ¨¡å‹"ä¼šè¢«è‡ªåŠ¨è®°å½•ä¸º"å½“å‰ä½¿ç”¨æ¨¡å‹"
- ç”¨æˆ·æ— éœ€ä»»ä½•æ‰‹åŠ¨æ“ä½œ
- æ‰€æœ‰åŠŸèƒ½ä¿æŒæ­£å¸¸å·¥ä½œ

### å¼€å‘æç¤º
- æ–°ä»£ç åº”ä½¿ç”¨ `get_current_model()` è€Œä¸æ˜¯ `get_default_model()`
- ä¿ç•™ `get_default_model()` æ˜¯ä¸ºäº†å‘åå…¼å®¹
- ä¸è¦å†ä½¿ç”¨æˆ–è®¾ç½® `is_default` å­—æ®µ

## ğŸ“ ç‰ˆæœ¬å†å²

- **v1.2.0** (2025-12-12)
  - ç§»é™¤"é»˜è®¤æ¨¡å‹"æ¦‚å¿µ
  - æ”¹ç”¨"å½“å‰ä½¿ç”¨æ¨¡å‹"
  - è‡ªåŠ¨è®°å¿†ç”¨æˆ·é€‰æ‹©
  - ç®€åŒ–ç”¨æˆ·ç•Œé¢

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [AIæ¨¡å‹SQLiteè¿ç§»](./AI_MODEL_SQLITE_MIGRATION.md)
- [AIæ¨¡å‹ä½¿ç”¨è¯´æ˜](./AI_MODEL_USAGE.md)


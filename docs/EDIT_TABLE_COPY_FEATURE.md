# 编辑表界面 - 复制功能增强

## 📋 功能说明

在编辑表界面中，增强了文本选择和复制功能，使用户可以方便地复制表结构信息。

## 🎯 新增功能

### 1. 文本可选择 ✨

**顶部连接信息**：
- 显示连接名称、数据库和表名的文本现在可以用鼠标选择
- 鼠标悬停时会显示文本光标（I型光标）
- 可以直接选中并使用 `Ctrl+C` 复制

**表信息标签**：
- 显示主键、注释等信息的标签文本可以选择
- 支持换行文本的选择
- 可以复制完整或部分信息

### 2. 右键菜单复制功能 ✨

在表结构表格中右键点击，可以看到增强的菜单：

```
┌─────────────────────────┐
│ 📋 复制选中字段         │ ← 新增
│ 📋 复制所有字段         │ ← 新增
│ ─────────────────────── │
│ 🔄 刷新                 │
└─────────────────────────┘
```

#### 复制选中字段

- 选中一个或多个字段行
- 右键点击，选择"📋 复制选中字段"
- 复制内容包含表头和选中的字段信息

**复制格式示例**：
```
字段名	类型	可空	默认值	注释
--------------------------------------------------------------------------------
id	INT	NO	NULL	用户ID
name	VARCHAR(100)	NO	NULL	用户名
email	VARCHAR(255)	YES	NULL	邮箱地址
```

#### 复制所有字段

- 右键点击表格任意位置
- 选择"📋 复制所有字段"
- 复制完整的表结构信息，包括：
  - 表名和数据库名
  - 所有字段详细信息
  - 主键信息
  - 索引列表

**复制格式示例**：
```
表名: users
数据库: test_database
--------------------------------------------------------------------------------
字段名	类型	可空	默认值	注释
--------------------------------------------------------------------------------
id	INT	NO	NULL	用户ID
name	VARCHAR(100)	NO	NULL	用户名
email	VARCHAR(255)	YES	NULL	邮箱地址
created_at	DATETIME	NO	CURRENT_TIMESTAMP	创建时间
updated_at	DATETIME	NO	CURRENT_TIMESTAMP	更新时间
--------------------------------------------------------------------------------
主键: id
注释: 用户信息表
--------------------------------------------------------------------------------
索引列表:
PRIMARY KEY (id)
INDEX idx_email (email)
INDEX idx_created_at (created_at)
```

## 🎨 使用场景

### 场景1：复制表名到其他工具

在编写SQL或文档时，需要引用表名：

1. 选中顶部的 `连接名 - database.table_name`
2. 按 `Ctrl+C` 复制
3. 粘贴到需要的地方

### 场景2：导出字段列表

需要整理表字段清单：

1. 右键点击表结构表格
2. 选择"📋 复制所有字段"
3. 粘贴到Excel、Word或文本文件
4. 由于使用Tab分隔，可以直接粘贴到表格软件

### 场景3：比对字段差异

需要比较不同表的字段：

1. 在表A的编辑界面，复制所有字段
2. 在表B的编辑界面，复制所有字段
3. 使用文本对比工具比较差异

### 场景4：分享表结构

需要向同事说明表结构：

1. 复制所有字段（包含完整信息）
2. 粘贴到聊天工具或邮件
3. 格式清晰，易于阅读

## 💡 使用技巧

### 技巧1：快速复制表名

只想复制表名，不需要数据库前缀：
- 双击顶部信息中的表名部分
- 部分选择后复制

### 技巧2：复制特定字段

只需要复制某几个字段：
- 按住 `Ctrl` 点击选择多行
- 右键选择"复制选中字段"

### 技巧3：粘贴到Excel

复制的内容使用Tab分隔：
- 直接粘贴到Excel会自动分列
- 每列对应一个字段属性

### 技巧4：复制索引信息

只需要索引信息：
- 索引列表区域的文本是可选择的
- 直接选中并复制

## 🔧 技术实现

### 1. QLabel文本可选择

**实现代码**：
```python
label.setTextInteractionFlags(Qt.TextInteractionFlag.TextSelectableByMouse)
label.setCursor(Qt.CursorShape.IBeamCursor)
```

**作用**：
- `TextSelectableByMouse` - 允许用鼠标选择文本
- `IBeamCursor` - 设置文本光标样式

### 2. 右键菜单增强

**菜单判断**：
```python
selected_rows = self.schema_table.selectionModel().selectedRows()
if selected_rows:
    # 显示复制选项
```

**复制选中字段**：
```python
def copy_selected_fields(self):
    # 获取选中行
    # 构建带表头的文本
    # 复制到剪贴板
    # 显示成功提示
```

**复制所有字段**：
```python
def copy_all_fields(self):
    # 构建完整表结构信息
    # 包含表名、字段、主键、索引
    # 复制到剪贴板
    # 显示成功提示
```

### 3. 格式化输出

- 使用 Tab (`\t`) 分隔列，兼容Excel
- 使用分隔线 (`-`) 美化显示
- 包含表头，便于理解
- 结构化组织，易于阅读

## 📊 修改的文件

**src/gui/widgets/edit_table_tab.py**：
1. ✅ 连接信息标签 - 添加文本可选择
2. ✅ 表信息标签 - 添加文本可选择
3. ✅ 右键菜单 - 添加复制选项
4. ✅ 新增方法 - `copy_selected_fields()`
5. ✅ 新增方法 - `copy_all_fields()`

## 🎯 用户反馈

### 优势

- ✨ **方便**：无需手动输入表名和字段
- ✨ **准确**：避免拼写错误
- ✨ **高效**：一键复制完整结构
- ✨ **灵活**：支持部分或全部复制

### 改进建议

- [ ] 支持复制为Markdown表格格式
- [ ] 支持复制为JSON格式
- [ ] 支持复制为CREATE TABLE语句
- [ ] 添加"复制字段名列表"快捷选项

## 🔗 相关功能

- [编辑表结构](./EDIT_TABLE_STRUCTURE.md)
- [表结构同步](./SCHEMA_SYNC_FEATURE.md)
- [复制表结构](./COPY_TABLE_STRUCTURE.md)

## 📝 更新日志

### v1.2.0 (2024-12-15)

- ✅ 新增：连接信息文本可选择
- ✅ 新增：表信息标签文本可选择
- ✅ 新增：右键菜单"复制选中字段"
- ✅ 新增：右键菜单"复制所有字段"
- ✅ 优化：复制格式，支持Excel粘贴
- ✅ 优化：包含完整表结构信息

---

**作者**: codeyG (550187704@qq.com)  
**版本**: v1.2.0  
**日期**: 2024-12-15

